var $jscomp={scope:{}};$jscomp.defineProperty="function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){if(c.get||c.set)throw new TypeError("ES3 does not support getters and setters.");a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.symbolCounter_=0;$jscomp.Symbol=function(a){return $jscomp.SYMBOL_PREFIX+(a||"")+$jscomp.symbolCounter_++};
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};$jscomp.findInternal=function(a,b,c){a instanceof String&&(a=String(a));for(var d=a.length,e=0;e<d;e++){var f=a[e];if(b.call(c,f,e,a))return{i:e,v:f}}return{i:-1,v:void 0}};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.polyfill("Array.prototype.find",function(a){return a?a:function(a,c){return $jscomp.findInternal(this,a,c).v}},"es6-impl","es3");
function iterate(a,b){if("object"!==typeof a||"object"!==typeof b)return!1;for(var c in a)if(a.hasOwnProperty(c))if("object"===typeof a[c]){if(!iterate(a[c],b[c]))return!1}else if((typeof b[c]).toLowerCase()!==a[c].toLowerCase())return!1;return!0}function getModule(a){var b=require.s.contexts._.defined,c;for(c in b)if(b.hasOwnProperty(c)){var d=b[c];if(iterate(a,d))return d}}"undefined"===typeof _$context&&(_$context=getModule({_events:{"AlertEvent:alert":"object"},dispatch:"function"}));
"undefined"===typeof PlugTime&&(PlugTime=getModule({getChatTimestamp:"function"}));"undefined"===typeof PlugSettings&&(PlugSettings=getModule({settings:"object"}));"undefined"!==typeof jplug&&jplug.__close();window.jplugLoad={start:0,end:0};
window.jplug={version:{major:null,minor:null,patch:null,notes:null},files:{js:"https://juici.github.io/jPlug/jplug.min.js",css:"https://juici.github.io/jPlug/jplug.min.css",version:"https://juici.github.io/jPlug/version.json",badges:"https://juici.github.io/jPlug/badges.json"},running:!1,other:{afk:{enabled:!1,message:null},badges:{}},settings:{mod:{chatLog:!1,historyAlert:!1,lengthAlert:!1,songAvailability:!0,deletedChat:!0},debug:!1,custom:{sounds:{},mentions:{enabled:!1,match:[]},colors:{},afk:{reason:":o where am i???",
message:"/me is afk ( %%reason%% ) right now @%%user%% - sorry kiddo",start:"/me is now afk ( %%reason%% ) - quick, mention them as much as possible",stop:"/me is no longer afk :o"},gif:{petme:"https://i.imgur.com/lU5Pf7b.gif",lick:"https://i.imgur.com/x7If57b.gif",dio:"https://i.imgur.com/JkXpkWe.gif",bye:"https://i.imgur.com/4jWtDX6.gif",byeflip:"https://i.imgur.com/hKcRui2.gif",steal:"https://i.imgur.com/tX0XW8a.gif",clap:"https://i.imgur.com/F29Li2R.gif",notlikethis:"https://i.imgur.com/ZLx9gHr.gif"},
meme:{steal:"https://i.imgur.com/NVpmaKa.png",deadchat:"https://i.imgur.com/lP7gPtd.jpg",diokong:"https://i.imgur.com/brnWOIZ.png",diobass:"https://i.imgur.com/Wp8K8IB.png"}}},utils:{_sandboxDocument:null,htmlentities:function(a){var b=jplug.utils._sandboxDocument;b&&"undefined"!==typeof b&&null!==b||(b=jplug.utils._sandboxDocument=document.implementation.createHTMLDocument("jplug-sandbox"));b=b.createElement("div");b.innerHTML=a;return b.textContent||b.text||b.innerText||""},striphtml:function(a){return a.replace(/<.*?>.*?<\/.*?>/gi,
"")},debug:function(a,b){jplug.settings.debug&&(0===$("#jplug-dev-log").size()&&$("#playback").after('<div id="jplug-dev-log" style="position:absolute; top:'+($(".app-header").height()+20)+'px; left:20px; width:250px; max-height: 600px; overflow-y:auto; padding:10px; color: #fff; background-color:rgba(20,20,20,.8); font-size:12px; text-align:left; z-index:100000"><strong>jPlug Dev Log</strong></div>'),"undefined"!==typeof a&&null!==a&&(console.log("[jPlug]",a),$("#jplug-dev-log").append("<div>"+a+
"</div>")),"undefined"!==typeof b&&null!==b&&(console.error("[jPlug]",b),$("#jplug-dev-log").append('<div style="color: #c42e3b;">'+b+"</div>")))},loadSettings:function(){jplug.utils.debug("Loading settings...");$.extend(jplug.settings,JSON.parse(localStorage.getItem("jplug-settings"))||{})},saveSettings:function(){localStorage.setItem("jplug-settings",JSON.stringify(jplug.settings));jplug.utils.debug("[settings] Settings saved")},checkLoad:function(){var a={hook:function(){jplug.utils.debug("[checkLoad] Checking load...");
0===$(".loading-box").size()&&"undefined"!==typeof rcs&&rcs.running?this.load():(jplug.utils.debug("[jplug] [checkLoad] Not yet loaded"),setTimeout(function(){return a.hook()},250))},load:function(){jplug.utils.getFiles(jplug.__init);jplug.utils.debug("[checkLoad] Loaded")}};a.hook()},getFiles:function(a){a=a||function(){};$("head").append('<style id="jplug-anchor"></style>');jplug.utils.loadSettings();jplug.utils.debug("Getting version...");jplug.utils.debug("[getFiles] Getting version info...");
$.getJSON(jplug.files.version,{cache:!1}).done(function(b){jplug.utils.debug("[getFiles] Retrieved version info");jplug.version.major=b.version.major;jplug.version.minor=b.version.minor;jplug.version.patch=b.version.patch;jplug.version.notes=b.notes;jplug.utils.debug("[getFiles] Getting badges...");$.getJSON(jplug.files.badges,{cache:!1}).done(function(b){jplug.utils.debug("[getFiles] Retrieved badges");jplug.badges=b;jplug.__badges();jplug.utils.debug("[getFiles] Loaded");a()})})},timeQuery:function(a){a instanceof
URL||(a=new URL(a));a.searchParams.set("_",Date.now());return a.href},getTimeStamp:function(){return 24===PlugSettings.settings.chatTimestamps?(new Date).toTimeString().split(" ")[0].slice(0,-3):12===PlugSettings.settings.chatTimestamps?PlugTime.getChatTimestamp():""},skip:function(){API.getDJ().id===API.getUser().id?$.post("/_/booth/skip/me"):API.moderateForceSkip()},woot:function(){API.getDJ()&&API.getDJ().id!==API.getUser().id&&$("woot").click()},meh:function(){API.getDJ()&&API.getDJ().id!==API.getUser().id&&
$("meh").click()},getWoots:function(){return API.getUsers().filter(function(a){return 1===a.vote})},getMehs:function(){return API.getUsers().filter(function(a){return-1===a.vote})},getGrabs:function(){return API.getUsers().filter(function(a){return a.grab})},searchHistory:function(a){return API.getHistory().filter(function(b){return-1<b.media.title.toLowerCase().indexOf(a.toLowerCase())})}},__chat:{log:function(a,b,c,d){this.rawLog(a,b,jplug.utils.striphtml(c),jplug.utils.striphtml(d))},logSmall:function(a,
b,c){this.rawLogSmall(a,b,jplug.utils.striphtml(c))},rawLog:function(a,b,c,d){var e="jplug-"+Date.now(),f=jplug.utils.getTimeStamp();$("#chat-messages").append('<div class="cm message jplug-log jplug-log-'+a+'" id="'+e+'"><div class="badge-box"><i class="'+b+'"></i></div><div class="msg"><div class="from"><span class="jplug-chat-title">'+c+'</span><span class="timestamp" style="display: inline;">'+f+'</span></div><div class="text">'+d+"</div></div></div>");rcs.Utils.scrollChat("#chat-messages");rcs.__chatMessages.deleteButton(e,
!1)},rawLogSmall:function(a,b,c){var d="jplug-"+Date.now(),e=jplug.utils.getTimeStamp();$("#chat-messages").append('<div class="cm message jplug-log sml jplug-log-'+a+'" id="'+d+'"><div class="badge-box"><i class="'+b+'"></i></div><div class="msg"><div class="from"><span class="timestamp" style="display: inline;">'+e+'</span></div><div class="text">'+c+"</div></div></div>");rcs.Utils.scrollChat("#chat-messages");rcs.__chatMessages.deleteButton(d,!1)}},checkUpdates:function(){jplug.utils.debug("[update] Checking for updates...");
jplug._updateChecked||$.getJSON(jplug.files.version,{cache:!1}).done(function(a){var b=a.version.major+"."+a.version.minor+"."+a.version.patch;jplug.utils.debug("[update] Latest: v"+b);jplug.utils.debug("[update] Local: v"+jplug.version.major+"."+jplug.version.minor+"."+jplug.version.patch);a.version.major>jplug.version.major||a.version.minor>jplug.version.minor||a.version.patch>jplug.version.patch?(jplug.utils.debug("[update] Found update: v"+b),b=jplug.utils.getTimeStamp(),$("#chat-messages").append('<div class="cm message jplug-log jplug-log-red" id="jplug-found-update"><div class="badge-box"><i class="icon icon-system-red"></i></div><div class="msg"><div class="from"><span class="jplug-chat-title">jPlug Update</span><span class="timestamp" style="display: inline;">'+
b+'</span></div><div class="text">An update for jPlug has been found - click here to update</div><div class="text"><br><strong>Includes:</strong><br>'+a.notes+"</div></div></div>"),jplug._updateChecked=!0,$("#jplug-found-update").on("click",function(){jplug.utils.debug("[update] Update button in chat clicked");$.getScript(jplug.files.js,{cache:!1});$("#jplug-found-update").off("click").remove()})):jplug.utils.debug("[update] No new updates found")})},listeners:{listeners:[{hook:API.CHAT,cb:"__CHAT"},
{hook:API.ADVANCE,cb:"__ADVANCE"},{hook:API.VOTE_UPDATE,cb:"__VOTE_UPDATE"},{hook:API.USER_JOIN,cb:"__USER_JOIN"},{hook:API.USER_LEAVE,cb:"__USER_LEAVE"},{hook:API.GRAB_UPDATE,cb:"__GRAB_UPDATE"},{hook:API.USER_SKIP,cb:"__SKIP"},{hook:API.MOD_SKIP,cb:"__SKIP"},{hook:API.WAIT_LIST_UPDATE,cb:"__WAIT_LIST_UPDATE"},{hook:API.CHAT_COMMAND,cb:"__CHAT_COMMAND"},{hook:API.SCORE_UPDATE,cb:"__SCORE_UPDATE"}],__active:!1,init:function(){if(!this.__active){for(var a=$jscomp.makeIterator(this.listeners),b=a.next();!b.done;b=
a.next())b=b.value,API.on(b.hook,jplug._proxy[b.cb]);this.__active=!0}},close:function(){if(this.__active){for(var a=$jscomp.makeIterator(this.listeners),b=a.next();!b.done;b=a.next())b=b.value,API.off(b.hook,jplug._proxy[b.cb]);this.__active=!1}}},initProxy:function(){this._proxy={__CHAT:$.proxy(this.__onChat,this),__ADVANCE:$.proxy(this.__onDJAdvance,this),__VOTE_UPDATE:$.proxy(this.__onVoteUpdate,this),__USER_JOIN:$.proxy(this.__onUserJoin,this),__USER_LEAVE:$.proxy(this.__onUserLeave,this),__GRAB_UPDATE:$.proxy(this.__onGrabUpdate,
this),__SKIP:$.proxy(this.__onSkip,this),__WAIT_LIST_UPDATE:$.proxy(this.__onWaitListUpdate,this),__CHAT_COMMAND:$.proxy(this.__onChatCommand,this),__SCORE_UPDATE:$.proxy(this.__onScoreUpdate,this)}},__onChat:function(a){jplug.__autoRespond(a)},__onDJAdvance:function(a){},__onVoteUpdate:function(a){jplug.__rcsMehList()},__onUserJoin:function(a){},__onUserLeave:function(a){},__onGrabUpdate:function(a){},__onSkip:function(a){},__onWaitListUpdate:function(a){},__onChatCommand:function(a){var b=a.split(" ");
a=String(b[0]).substring(1).toLowerCase();var b=b.slice(1),c;for(c in jplug.commands){var d=jplug.commands[c].cmd;Array.isArray(d)||(d=[d]);for(var d=$jscomp.makeIterator(d),e=d.next();!e.done;e=d.next())if(a===e.value){jplug.commands[c].fn(a,b);break}}},__onScoreUpdate:function(a){},commands:{reload:{cmd:["jreload","jplugreload","reloadjplug"],fn:function(a,b){jplug.utils.debug("[reload] Command forced reload");$.getScript(jplug.files.js,{cache:!1})}},afk:{cmd:"afk",fn:function(a,b){var c=":o where am i???";
if(0===b.length){if(jplug.other.afk.enabled){jplug.other.afk.enabled=!1;jplug.__chat.logSmall("yellow","","AFK: false");API.sendChat(jplug.settings.custom.afk.stop);return}}else c=b.join(" ");jplug.other.afk.enabled=!0;jplug.other.afk.reason=c;jplug.__chat.logSmall("yellow","","AFK: true ("+c+")");API.sendChat(jplug.settings.custom.afk.start.replace(/%%reason%%/g,c))}},gif:{cmd:"gif",fn:function(a,b){var c=b.join(" ");jplug.settings.custom.gif.hasOwnProperty(c)?API.sendChat(jplug.settings.custom.gif[c]):
jplug.__chat.logSmall("red","icon icon-system-red","Unknown gif: "+c)}},meme:{cmd:"meme",fn:function(a,b){var c=b.join(" ");jplug.settings.custom.meme.hasOwnProperty(c)?API.sendChat(jplug.settings.custom.meme[c]):jplug.__chat.logSmall("red","icon icon-system-red","Unknown meme: "+c)}},blocked:{cmd:["blocked","available","restricted"],fn:function(a,b){jplug.__chat.rawLogSmall("red","icon icon-x-grey",'<a href="https://polsy.org.uk/stuff/ytrestrict.cgi?ytid='+API.getMedia().cid+'" target="_blank">Restriction Check</a>')}},
hi:{cmd:"hi",fn:function(a,b){API.sendChat((":roohi: "+b.join(" ")).trim())}}},__init:function(){jplugLoad.start=(new Date).getTime();jplug.utils.debug("[init] Loading script...");try{jplug.running||(jplug.utils.debug("[init] Loading listeners..."),jplug.initProxy(),jplug.listeners.init(),jplug.utils.debug("[init] Listeners enabled"),$(window).on("beforeunload.plug",function(){return jplug.utils.saveSettings()}),jplug.utils.debug("[init] Adding UI content..."),jplug.utils.debug("[init] UI content added"),
jplug.__deletedChat(),jplug.running=!0,jplug.utils.debug("[init] Starting features..."),jplug.utils.debug("[init] Adding chat suggestions..."),jplug.utils.debug("[init] Starting intervals..."),jplug._tickUpdate=setInterval(jplug.checkUpdates,3E5),jplug.utils.debug("[init] Loading styling..."),$("head").append('<link rel="stylesheet" type="text/css" id="jplug-css" href="'+jplug.utils.timeQuery(jplug.files.css)+'" />'),jplugLoad.end=(new Date).getTime(),jplug.__chat.rawLogSmall("blue","icon icon-tick-white",
"Activated jPlug v"+jplug.version.major+"."+jplug.version.minor+"."+jplug.version.patch+"<br>Loaded in "+(jplugLoad.end-jplugLoad.start)+"ms"))}catch(a){throw console.error("[jPlug] [ERROR] "+a),a;}},__close:function(){try{jplug.running&&(this.listeners.close(),clearInterval(jplug._tickUpdate),$(window).off("beforeunload.plug"),jplug.utils.saveSettings(),jplug.running=!1,$("#chat-messages").find(".jplug-deleted-message").remove(),$(".cm.jplug-log").remove(),$('[id^="jplug-"]').off("click").remove(),
_$context._events["chat:delete"][0].callback=function(a){try{this.lastText&&this.lastText.hasClass("cid-"+a)&&(this.lastID=this.lastType=this.lastText=this.lastTime=void 0);var b=this.$(".cid-"+a).closest(".cm");b.find("*").off();b.empty().remove()}catch(c){console.error(c,a)}},$("#jplug-dev-log").remove(),jplug.__chat.logSmall("red","icon icon-system-red","Deactivated jPlug"),$(window).trigger("resize"))}catch(a){throw console.error("[jPlug] [ERROR] "+a),a;}},__rcsMehList:function(){0<$("#meh-rs-list").size()&&
($("#meh-rs-list").html(""),API.getUsers().forEach(function(a){-1===a.vote&&$("#meh-rs-list").append($('<p id="'+a.id+'"></p>').text(a.username))}))},__autoRespond:function(a){a.message=jplug.utils.htmlentities(a.message);a.message=a.message.trim();var b=API.getUser().username,c=new RegExp("@"+b,"gi"),d=new RegExp("(?:@(.*?)\\s+)?\\bpets\\s+@"+b+"\\b","i"),e=new RegExp("(?:\\bhugs\\s+@"+b+"\\b|@"+b+".*?@.*?\\b(?:gives\\s+you\\s+a\\s+(?:big\\s+)?hug|hugs\\s+you)\\b)","i"),b=new RegExp("(?:@(.*?)\\s+)?\\b(?:boops|pokes)\\s+@"+
b+"\\b");jplug.other.afk.enabled&&c.test(a.message)?API.sendChat(jplug.settings.custom.afk.message.replace(/%%user%%/gi,a.un).replace(/%%reason%%/gi,jplug.other.afk.reason)):d.test(a.message)?(c=d.exec(a.message),c=1<c.length&&"undefined"!==typeof c[1]?c[1]:a.un,API.sendChat("/me purrs happily at @"+c+" :nekospin:")):e.test(a.message)?API.sendChat("D-don't hug me, it's not like I like you b-baka! :roobaka:"):b.test(a.message)&&(c=b.exec(a.message),c=1<c.length&&"undefined"!==typeof c[1]?c[1]:a.un,
API.sendChat("/me :roowhat: :roogasm: :rooshy: :roobaka: ... @"+c+" baka"))},__deletedChat:function(){_$context._events["chat:delete"][0].callback=function(a){try{this.lastText&&this.lastText.hasClass("cid-"+a)&&(this.lastID=this.lastType=this.lastText=this.lastTime=void 0);var b=this.$(".cid-"+a).closest(".cm");if((jplug.settings.deletedChat||rcs.settings.deletedChat)&&jplug.running&&rcs.running)if(rcs.settings.improvedChat&&!rcs.settings.oldChat){var c=b.find(".contents.cid-"+a);c.addClass("jplug-deleted-message");
c.find(".rcs-small-delete").remove();var d=b.find(".text"),e=d.find(".jplug-deleted-message");d.children().length===e.length&&(b.addClass("jplug-deleted-message"),d.children().removeClass("jplug-deleted-message"))}else b.addClass("jplug-deleted-message"),jplug.settings.hideDeleted&&(b.addClass("text-hidden"),rcs.Utils.hideButton(a));else if(rcs.settings.improvedChat&&rcs.running&&!rcs.settings.oldChat){b.find(".contents.cid-"+a).remove();var f=b.find(".text"),e=f.find(".jplug-deleted-message");f.children().length===
e.length&&(b.find("*").off(),b.empty().remove())}else b.find("*").off(),b.empty().remove()}catch(g){console.error(g,a)}}},__badges:function(){var a=[],b=API.getUser().id,c;for(c in jplug.other.badges)a.push("#chat .id-"+c+" .badge-box .bdg, #user-rollover.id-"+c+" .badge-box .bdg { background-image: url("+jplug.other.badges[c]+") !important; background-size: cover !important }"),parseInt(c)===b&&a.push("#footer-user .badge .bdg { background-image: url("+jplug.other.badges[c]+") !important; background-size: cover !important }")}};
jplug.utils.checkLoad();
